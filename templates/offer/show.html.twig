{% extends 'base.html.twig' %}

{% block title %}{{ offer.title }}{% endblock %}

{% block body %}
    <h1>{{ offer.title }}</h1>

    <p><strong>Entreprise :</strong> {{ offer.company.name }}</p>
    <p><strong>Auteur :</strong> {{ offer.author.email }}</p>
    <p><strong>Statut :</strong> {{ offer.status }}</p>

    <p>{{ offer.description }}</p>

    <p><strong>Catégories d’impact :</strong>
        {% if offer.impactCategories is not empty %}
            {{ offer.impactCategories|join(', ') }}
        {% else %}
            <em>Aucune</em>
        {% endif %}
    </p>

    <p>
        <a href="{{ path('offer_edit', {id: offer.id}) }}">Modifier</a>
        |
        <a href="{{ path('offer_index') }}">Retour à la liste</a>
    </p>

    {% if is_granted('ROLE_ADMIN') %}
        <section>
            <h2>Visibilité</h2>
            <form method="post" action="{{ path('offer_toggle_visibility', {id: offer.id}) }}">
                <input type="hidden" name="_token" value="{{ csrf_token('toggle_visibility_' ~ offer.id) }}">
                <button class="btn" type="submit">
                    {{ offer.isVisible ? 'Masquer' : 'Rendre visible' }}
                </button>
            </form>
        </section>
    {% endif %}

    {% if offer.status == constant('App\\Entity\\Offer::STATUS_DRAFT') %}
        <section>
            <h2>Publier l’offre</h2>
            <form method="post" action="{{ path('offer_publish', {id: offer.id}) }}">
                <input type="hidden" name="_token" value="{{ csrf_token('publish_offer_' ~ offer.id) }}">
                <button class="btn" type="submit">Publier</button>
            </form>
        </section>
    {% endif %}

    
{% endblock %}
